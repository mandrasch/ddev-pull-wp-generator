<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="description" content="" />
		<link rel="icon" href="/ddev-wp-boilerplate/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>DDEV WP Boilerplate Generator</title><!-- HTML_TAG_START --><style>pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><!-- HTML_TAG_END -->

		

		<link rel="stylesheet" href="/ddev-wp-boilerplate/_app/assets/start-c446e5f0.css">
		<link rel="stylesheet" href="/ddev-wp-boilerplate/_app/assets/vendor-4e7da6e6.css">
		<link rel="stylesheet" href="/ddev-wp-boilerplate/_app/assets/pages/__layout.svelte-4e723f17.css">
		<link rel="modulepreload" href="/ddev-wp-boilerplate/_app/start-33a43e6d.js">
		<link rel="modulepreload" href="/ddev-wp-boilerplate/_app/chunks/vendor-e80681f4.js">
		<link rel="modulepreload" href="/ddev-wp-boilerplate/_app/pages/__layout.svelte-f40ee181.js">
		<link rel="modulepreload" href="/ddev-wp-boilerplate/_app/pages/index.svelte-11bad7c6.js">

		<script type="module">
			import { start } from "/ddev-wp-boilerplate/_app/start-33a43e6d.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"/ddev-wp-boilerplate","assets":"/ddev-wp-boilerplate"},
				session: {},
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/ddev-wp-boilerplate/_app/pages/__layout.svelte-f40ee181.js"),
						import("/ddev-wp-boilerplate/_app/pages/index.svelte-11bad7c6.js")
					],
					url: new URL("http://prerender/"),
					params: {}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">




<main><div class="container px-5 my-5"><h1>DDEV WP Boilerplate Generator</h1>
	<div class="container px-5 my-5"><form id="contactForm"><div class="mb-3"><label class="form-label" for="projectName">Project name</label>
		<input class="form-control" id="projectName" type="text" placeholder="Project name" value="my-project"></div>
	<div class="mb-3"><label class="form-label d-block">PHP version</label>
		<div class="form-check form-check-inline"><input class="form-check-input" id="8.0" type="radio" name="phpVersion" value="8.0">
				<label class="form-check-label" for="8.0">8.0</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="7.4" type="radio" name="phpVersion" value="7.4" checked>
				<label class="form-check-label" for="7.4">7.4</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="7.3" type="radio" name="phpVersion" value="7.3">
				<label class="form-check-label" for="7.3">7.3</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="7.2" type="radio" name="phpVersion" value="7.2">
				<label class="form-check-label" for="7.2">7.2</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="7.1" type="radio" name="phpVersion" value="7.1">
				<label class="form-check-label" for="7.1">7.1</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="7.0" type="radio" name="phpVersion" value="7.0">
				<label class="form-check-label" for="7.0">7.0</label>
			</div><div class="form-check form-check-inline"><input class="form-check-input" id="5.6" type="radio" name="phpVersion" value="5.6">
				<label class="form-check-label" for="5.6">5.6</label>
			</div></div>
	<div class="mb-3"><label class="form-label" for="database">Database version</label>
		<div class="form-check"><input class="form-check-input" id="dbVersion0" type="radio" name="dbVersion" value="maria-10.3" checked>
				<label class="form-check-label" for="dbVersion0">MariaDB 10.3 (default)</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion1" type="radio" name="dbVersion" value="maria-10.4">
				<label class="form-check-label" for="dbVersion1">MariaDB 10.4</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion2" type="radio" name="dbVersion" value="maria-10.5">
				<label class="form-check-label" for="dbVersion2">MariaDB 10.5</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion3" type="radio" name="dbVersion" value="maria-10.6">
				<label class="form-check-label" for="dbVersion3">MariaDB 10.6</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion4" type="radio" name="dbVersion" value="mysql-5.5">
				<label class="form-check-label" for="dbVersion4">MySQL 5.5</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion5" type="radio" name="dbVersion" value="mysql-5.6">
				<label class="form-check-label" for="dbVersion5">MySQL 5.6</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion6" type="radio" name="dbVersion" value="mysql-5.7">
				<label class="form-check-label" for="dbVersion6">MySQL 5.7</label>
			</div><div class="form-check"><input class="form-check-input" id="dbVersion7" type="radio" name="dbVersion" value="mysql-8.0">
				<label class="form-check-label" for="dbVersion7">MySQL 8.0</label>
			</div></div>
	<div class="mb-3"><label class="form-label d-block">Web server</label>
		<div class="form-check form-check-inline"><input class="form-check-input" id="nginx" type="radio" name="webServerType" value="nginx" checked>
			<label class="form-check-label" for="nginx">nginx</label></div>
		<div class="form-check form-check-inline"><input class="form-check-input" id="apache2" type="radio" value="apache2" name="webServerType">
			<label class="form-check-label" for="apache2">apache2</label></div></div>
	<div class="mb-3"><label class="form-label" for="childThemeFolderName">Child theme folder (in wp-content/themes/)</label>
		<input class="form-control" id="childThemeFolderName" type="text" placeholder="twentytwentyone-child" value="twentytwentyone-child">
		<div class="invalid-feedback" data-sb-feedback="childThemeFolderInWpContentThemes:required">Child theme folder (in wp-content/themes/) is required.
		</div></div>
	<div class="mb-3"><label class="form-label" for="sshHost">SSH host</label>
		<input class="form-control" id="sshHost" type="text" placeholder="example.org" value=""></div>
	<div class="mb-3"><label class="form-label" for="sshUsername">SSH username</label>
		<input class="form-control" id="sshUsername" type="text" placeholder="user123" value=""></div>
	<div class="mb-3"><label class="form-label" for="pathToWordPressOnServer">Path to WordPress on server</label>
		<input class="form-control" id="pathToWordPressOnServer" type="text" placeholder="/sites/my-website.eu/" value=""></div>
	<div class="d-none" id="submitSuccessMessage"><div class="text-center mb-3"><div class="fw-bolder">Form submission successful!</div>
			<p>To activate this form, sign up at</p>
			<a href="https://startbootstrap.com/solution/contact-forms">https://startbootstrap.com/solution/contact-forms</a></div></div>
	<div class="d-none" id="submitErrorMessage"><div class="text-center text-danger mb-3">Error sending message!</div></div>
	<div class="d-grid"><button class="btn btn-primary btn-lg disabled" id="submitButton" type="submit">Submit</button></div></form></div>
	<div class="container px-5 my-5">

<h2>Code Generator:</h2>

<h3>1. .ddev/config.yaml</h3>

  <pre data-language="yaml" class=" svelte-19wij0g"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-attr">name:</span> <span class="hljs-string">my-project</span>
<span class="hljs-attr">type:</span> <span class="hljs-string">wordpress</span>
<span class="hljs-attr">docroot:</span> <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-attr">php_version:</span> <span class="hljs-string">&quot;7.4&quot;</span>
<span class="hljs-attr">webserver_type:</span> <span class="hljs-string">nginx</span>
<span class="hljs-attr">router_http_port:</span> <span class="hljs-string">&quot;80&quot;</span>
<span class="hljs-attr">router_https_port:</span> <span class="hljs-string">&quot;443&quot;</span>
<span class="hljs-attr">xdebug_enabled:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">additional_hostnames:</span> []
<span class="hljs-attr">additional_fqdns:</span> []
<span class="hljs-attr">mariadb_version:</span> <span class="hljs-string">&quot;10.3&quot;</span>
<span class="hljs-attr">nfs_mount_enabled:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">mutagen_enabled:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">use_dns_when_possible:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">composer_version:</span> <span class="hljs-string">&quot;2&quot;</span>
<span class="hljs-attr">web_environment:</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">PRODUCTION_SSH_USER=</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">PRODUCTION_SSH_HOST=</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">PRODUCTION_SSH_WP_DIR=</span><!-- HTML_TAG_END --></code></pre>


<h3>2. .gitignore</h3>


  <pre data-language="plaintext" class=" svelte-19wij0g"><code class="hljs">
# Ignore all ...
*

# ... but track specific files / folders: 

!.gitignore
!/README.md
!/LICENSE

# DDEV config
!/.ddev
/.ddev/*
!/.ddev/config.yaml
!/.ddev/providers
/.ddev/providers/*
!/.ddev/providers/wp-production.yaml

# child theme:
!/wp-content
/wp-content/*
!/wp-content/themes
/wp-content/themes/*
!/wp-content/themes/twentytwentyone-child
</code></pre>


<h3>3. .ddev/providers/wp-production.yaml</h3>


  <pre data-language="yaml" class=" svelte-19wij0g"><code class="hljs"><!-- HTML_TAG_START --><span class="hljs-comment"># Pull a live site into DDEV</span>

<span class="hljs-comment"># This pulls a live wordpress site via SSH, </span>
<span class="hljs-comment"># WP-CLI (or mysqldump) and rsync into DDEV.</span>

<span class="hljs-comment"># Usage:</span>
<span class="hljs-comment"># 1. Add environment as web_environment to config.yaml</span>
<span class="hljs-comment"># 2. Run &#x27;ddev pull wp-production&#x27;</span>

<span class="hljs-comment"># More general information regarding the DDEV pull feature:</span>
<span class="hljs-comment"># https://ddev.readthedocs.io/en/stable/users/providers/provider-introduction/</span>

<span class="hljs-comment"># !! MAKE SURE YOU GOT DDEV VERSION &gt;= 1.18.2 !!</span>
<span class="hljs-comment"># https://github.com/drud/ddev/releases</span>
<span class="hljs-comment"># (Otherwise overriding files_import_command won&#x27;t work)</span>

<span class="hljs-attr">environment_variables:</span>
  <span class="hljs-attr">sshUser:</span> <span class="hljs-string">${PRODUCTION_SSH_USER}</span>
  <span class="hljs-attr">sshHost:</span> <span class="hljs-string">${PRODUCTION_SSH_HOST}</span>
  <span class="hljs-attr">sshWpDir:</span> <span class="hljs-string">${PRODUCTION_SSH_WP_DIR}</span>
  <span class="hljs-comment"># These values are loaded via .ddev/config.yaml, you need </span>
  <span class="hljs-comment"># to add the following to .ddev/config.yaml and run &#x27;ddev restart&#x27;:</span>
  <span class="hljs-comment"># </span>
  <span class="hljs-comment"># web_environment:</span>
  <span class="hljs-comment"># - PRODUCTION_SSH_USER=ssh12345678</span>
  <span class="hljs-comment"># - PRODUCTION_SSH_HOST=ngcobalt12345678.manitu.net</span>
  <span class="hljs-comment"># - PRODUCTION_SSH_WP_DIR=/home/sites/site12345678/web/nature-blog.mandrasch.eu</span>
  <span class="hljs-comment"># </span>
  <span class="hljs-comment"># See: https://ddev.readthedocs.io/en/stable/users/extend/customization-extendibility/#providing-custom-environment-variables-to-a-container</span>

<span class="hljs-comment"># 1. Add ssh keys to the user agent</span>
<span class="hljs-attr">auth_command:</span>
  <span class="hljs-attr">command:</span> <span class="hljs-string">|
    ssh-add -l &gt;/dev/null || ( echo &quot;Please &#x27;ddev auth ssh&#x27; before running this command.&quot; &amp;&amp; exit 1 )
</span>
<span class="hljs-comment"># 2. Pull a fresh database dump via SSH</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment"># (The database url replace-search will be done later in</span>
<span class="hljs-comment"># files_import_command,because we need wp-config.php for it)</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment"># If WP-CLI is available on server: </span>
<span class="hljs-comment"># Use &#x27;wp db export&#x27; command, it&#x27;ll use wp-config.php DB settings </span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># If WP-CLI is not available, try with mysqldump:</span>
<span class="hljs-comment"># Use mysqldump and get db connection from wp-config.php via bash,</span>
<span class="hljs-comment"># thanks to https://tomjn.com/2014/03/01/wordpress-bash-magic/</span>
<span class="hljs-comment"># Important: Use backslash for mysqldump values, thanks to </span>
<span class="hljs-comment"># https://stackoverflow.com/a/13826220</span>
<span class="hljs-comment"># </span>
<span class="hljs-attr">db_pull_command:</span>
  <span class="hljs-attr">command:</span> <span class="hljs-string">|
    # set -x   # You can enable bash debugging output by uncommenting
    set -eu -o pipefail
    pushd &quot;/var/www/html/${DDEV_DOCROOT}&quot; &gt;/dev/null
    echo &quot;Connect to SSH and check if WP-CLI is available ...&quot;
    # TODO: is there a more robust way? Any unexpected output will cause an error?
    WP_CLI_AVAILABLE=&quot;$(ssh ${sshUser}@${sshHost} &quot;cd ${sshWpDir} &amp;&amp; if [[ -x &#x27;command -v wp&#x27; ]]; then echo &quot;1&quot;; else echo &quot;0&quot;; fi&quot;)&quot;
    if [ &quot;$WP_CLI_AVAILABLE&quot; = &quot;1&quot; ]; then echo &quot;WP-CLI is available remotely&quot;; else echo &quot;WP-CLI not available remotely, we&#x27;ll try mysqldump instead&quot;; fi
    #
    # Database dump via WP-CLI &#x27;wp db export&#x27;:
    # 
    if [ &quot;$WP_CLI_AVAILABLE&quot; = &quot;1&quot; ]; then ssh ${sshUser}@${sshHost} &quot;cd ${sshWpDir} &amp;&amp; wp db export | gzip -9 -c&quot; &gt; .ddev/.downloads/db.sql.gz; fi
    #
    # Database dump via mysqldump (if WP-CLI not available):
    #
    if [ &quot;$WP_CLI_AVAILABLE&quot; = &quot;0&quot; ]; then ssh ${sshUser}@${sshHost} &quot;cd ${sshWpDir} &amp;&amp; mysqldump --user=$(cat wp-config.php | grep DB_USER | cut -d &#x27; -f 4) --password=$(cat wp-config.php | grep DB_PASSWORD | cut -d &#x27; -f 4) --host=$(cat wp-config.php | grep DB_HOST | cut -d &#x27; -f 4) $(cat wp-config.php | grep DB_NAME | cut -d &#x27; -f 4) | gzip -9 -c&quot; &gt; .ddev/.downloads/db.sql.gz; fi
    # 
</span>  <span class="hljs-attr">service:</span> <span class="hljs-string">web</span>

<span class="hljs-comment"># 3. Rsync all the files (except git-tracked ones)</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment"># We rsync files from remote to local docroot which are _not_ tracked via git</span>
<span class="hljs-comment"># (This allows us to track a child theme in git and doesnt&#x27;t overwrite it. It is</span>
<span class="hljs-comment"># achieved with --include-from=&#x27;.gitignore&#x27; --exclude=&#x27;*&#x27;)</span>
<span class="hljs-attr">files_pull_command:</span>
  <span class="hljs-attr">command:</span> <span class="hljs-string">|
    # set -x   # You can enable bash debugging output by uncommenting
    set -eu -o pipefail
    ls /var/www/html/.ddev &gt;/dev/null # This just refreshes stale NFS if possible
    pushd /var/www/html/${DDEV_DOCROOT} &gt;/dev/null
    # Add trailing slash for sshWpDir if missing, 
    # thanks to https://gist.github.com/luciomartinez/c322327605d40f86ee0c
    [[ &quot;${sshWpDir}&quot; != */ ]] &amp;&amp; sshWpDir=&quot;${sshWpDir}/&quot;
    # Sync files from remote (${sshUser}@${sshHost}:${sshWpDir}) to local docroot (.)
    rsync -azh --progress --stats --include-from=&#x27;.gitignore&#x27; --exclude=&#x27;*&#x27; ${sshUser}@${sshHost}:${sshWpDir} .
</span>  <span class="hljs-attr">service:</span> <span class="hljs-string">web</span>

<span class="hljs-comment"># 4. Set database connection + migrate URLs in DB</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment"># We use this step to run some important WP-CLI commands locally</span>
<span class="hljs-comment"># a) Replace db connection settings in wp-config.php</span>
<span class="hljs-comment"># b) Replace live site url (determined from backup)</span>
<span class="hljs-comment"># with DDEV_PRIMARY_URL (&lt;your-project&gt;.ddev.site) in local databse</span>
<span class="hljs-comment"># <span class="hljs-doctag">TODO:</span> c) re-generate permalinks? other steps needed?</span>
<span class="hljs-attr">files_import_command:</span>
  <span class="hljs-attr">command:</span> <span class="hljs-string">|
    # set -x  # You can enable bash debugging output by uncommenting
    set -eu -o pipefail
    pushd &quot;/var/www/html/${DDEV_DOCROOT}&quot; &gt;/dev/null
    echo &quot;Adjusting wp-config db connection settings for DDEV ...&quot;
    wp config set DB_NAME &quot;db&quot; &amp;&amp; wp config set DB_USER &quot;db&quot; &amp;&amp; wp config set DB_PASSWORD &quot;db&quot; &amp;&amp; wp config set DB_HOST &quot;db&quot;
    # Important use wp search-replace for URL replacement
    echo &quot;Replacing the old URL ($(wp option get siteurl)) in database with DDEV local url (${DDEV_PRIMARY_URL})...&quot;
    wp search-replace $(wp option get siteurl) &quot;${DDEV_PRIMARY_URL}&quot;
    # echo &quot;Deleting config path for WP Super Cache (if installed) ...&quot;
    # wp config delete WPCACHEHOME
    echo &quot;All set, have fun! Run &#x27;ddev launch&#x27; to open your site.&quot;
</span>  <span class="hljs-attr">service:</span> <span class="hljs-string">web</span>
<!-- HTML_TAG_END --></code></pre>

Source:
<a href="https://github.com/mandrasch/ddev-wp-groundstation/blob/main/.ddev/providers/wp-production.yaml">https://github.com/mandrasch/ddev-wp-groundstation/blob/main/.ddev/providers/wp-production.yaml</a>
<div class="row"><h2>Afterwards:</h2>

	<ol><li>Create a new project folder (or create empty GitHub project)</li>
		<li>Copy the generated file contents to the new project folder</li>
		<li>Download your child theme into wp-content/themes/your-child-theme to manage it via git-tracked
		</li>
		<li>Run &quot;ddev start&quot;</li>
		<li>Run &quot;ddev auth ssh&quot;</li>
		<li>Pull your live site to the local project: &quot;ddev pull wp-production&quot;</li>
		<li>Optional: Git commit &amp; setup child theme via WPPusher (or other methods)</li></ol></div></div></div>
</main>

</div>
	</body>
</html>
